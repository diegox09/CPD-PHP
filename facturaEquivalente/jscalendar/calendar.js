/*Copyright Mihai Bazon, 2002-2005 | www.bazon.net/mishoo The DHTML Calendar, version 1.0*/
Calendar=function(a,b,c,d){this.activeDiv=null;this.currentDateEl=null;this.getDateStatus=null;this.getDateToolTip=null;this.getDateText=null;this.timeout=null;this.onSelected=c||null;this.onClose=d||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT["DEF_DATE_FORMAT"];this.ttDateFormat=Calendar._TT["TT_DATE_FORMAT"];this.isPopup=true;this.weekNumbers=true;this.firstDayOfWeek=typeof a=="number"?a:Calendar._FD;this.showsOtherMonths=false;this.dateStr=b;this.ar_days=null;this.showsTime=false;this.time24=true;this.yearStep=2;this.hiliteToday=true;this.multiple=null;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined")Calendar._SDN_len=3;var e=new Array;for(var f=8;f>0;){e[--f]=Calendar._DN[f].substr(0,Calendar._SDN_len)}Calendar._SDN=e;if(typeof Calendar._SMN_len=="undefined")Calendar._SMN_len=3;e=new Array;for(var f=12;f>0;){e[--f]=Calendar._MN[f].substr(0,Calendar._SMN_len)}Calendar._SMN=e}};Calendar._C=null;Calendar.is_ie=/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent);Calendar.is_ie5=Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent);Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.getAbsolutePos=function(a){var b=0,c=0;var d=/^div$/i.test(a.tagName);if(d&&a.scrollLeft)b=a.scrollLeft;if(d&&a.scrollTop)c=a.scrollTop;var e={x:a.offsetLeft-b,y:a.offsetTop-c};if(a.offsetParent){var f=this.getAbsolutePos(a.offsetParent);e.x+=f.x;e.y+=f.y}return e};Calendar.isRelated=function(a,b){var c=b.relatedTarget;if(!c){var d=b.type;if(d=="mouseover"){c=b.fromElement}else if(d=="mouseout"){c=b.toElement}}while(c){if(c==a){return true}c=c.parentNode}return false};Calendar.removeClass=function(a,b){if(!(a&&a.className)){return}var c=a.className.split(" ");var d=new Array;for(var e=c.length;e>0;){if(c[--e]!=b){d[d.length]=c[e]}}a.className=d.join(" ")};Calendar.addClass=function(a,b){Calendar.removeClass(a,b);a.className+=" "+b};Calendar.getElement=function(a){var b=Calendar.is_ie?window.event.srcElement:a.currentTarget;while(b.nodeType!=1||/^div$/i.test(b.tagName))b=b.parentNode;return b};Calendar.getTargetElement=function(a){var b=Calendar.is_ie?window.event.srcElement:a.target;while(b.nodeType!=1)b=b.parentNode;return b};Calendar.stopEvent=function(a){a||(a=window.event);if(Calendar.is_ie){a.cancelBubble=true;a.returnValue=false}else{a.preventDefault();a.stopPropagation()}return false};Calendar.addEvent=function(a,b,c){if(a.attachEvent){a.attachEvent("on"+b,c)}else if(a.addEventListener){a.addEventListener(b,c,true)}else{a["on"+b]=c}};Calendar.removeEvent=function(a,b,c){if(a.detachEvent){a.detachEvent("on"+b,c)}else if(a.removeEventListener){a.removeEventListener(b,c,true)}else{a["on"+b]=null}};Calendar.createElement=function(a,b){var c=null;if(document.createElementNS){c=document.createElementNS("http://www.w3.org/1999/xhtml",a)}else{c=document.createElement(a)}if(typeof b!="undefined"){b.appendChild(c)}return c};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true)}}};Calendar.findMonth=function(a){if(typeof a.month!="undefined"){return a}else if(typeof a.parentNode.month!="undefined"){return a.parentNode}return null};Calendar.findYear=function(a){if(typeof a.year!="undefined"){return a}else if(typeof a.parentNode.year!="undefined"){return a.parentNode}return null};Calendar.showMonthsCombo=function(){var a=Calendar._C;if(!a){return false}var a=a;var b=a.activeDiv;var c=a.monthsCombo;if(a.hilitedMonth){Calendar.removeClass(a.hilitedMonth,"hilite")}if(a.activeMonth){Calendar.removeClass(a.activeMonth,"active")}var d=a.monthsCombo.getElementsByTagName("div")[a.date.getMonth()];Calendar.addClass(d,"active");a.activeMonth=d;var e=c.style;e.display="block";if(b.navtype<0)e.left=b.offsetLeft+"px";else{var f=c.offsetWidth;if(typeof f=="undefined")f=50;e.left=b.offsetLeft+b.offsetWidth-f+"px"}e.top=b.offsetTop+b.offsetHeight+"px"};Calendar.showYearsCombo=function(a){var b=Calendar._C;if(!b){return false}var b=b;var c=b.activeDiv;var d=b.yearsCombo;if(b.hilitedYear){Calendar.removeClass(b.hilitedYear,"hilite")}if(b.activeYear){Calendar.removeClass(b.activeYear,"active")}b.activeYear=null;var e=b.date.getFullYear()+(a?1:-1);var f=d.firstChild;var g=false;for(var h=12;h>0;--h){if(e>=b.minYear&&e<=b.maxYear){f.innerHTML=e;f.year=e;f.style.display="block";g=true}else{f.style.display="none"}f=f.nextSibling;e+=a?b.yearStep:-b.yearStep}if(g){var i=d.style;i.display="block";if(c.navtype<0)i.left=c.offsetLeft+"px";else{var j=d.offsetWidth;if(typeof j=="undefined")j=50;i.left=c.offsetLeft+c.offsetWidth-j+"px"}i.top=c.offsetTop+c.offsetHeight+"px"}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal){return false}if(cal.timeout){clearTimeout(cal.timeout)}var el=cal.activeDiv;if(!el){return false}var target=Calendar.getTargetElement(ev);ev||(ev=window.event);Calendar.removeClass(el,"active");if(target==el||target.parentNode==el){Calendar.cellClick(el,ev)}var mon=Calendar.findMonth(target);var date=null;if(mon){date=new Date(cal.date);if(mon.month!=date.getMonth()){date.setMonth(mon.month);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}else{var year=Calendar.findYear(target);if(year){date=new Date(cal.date);if(year.year!=date.getFullYear()){date.setFullYear(year.year);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev)}};Calendar.tableMouseOver=function(a){var b=Calendar._C;if(!b){return}var c=b.activeDiv;var d=Calendar.getTargetElement(a);if(d==c||d.parentNode==c){Calendar.addClass(c,"hilite active");Calendar.addClass(c.parentNode,"rowhilite")}else{if(typeof c.navtype=="undefined"||c.navtype!=50&&(c.navtype==0||Math.abs(c.navtype)>2))Calendar.removeClass(c,"active");Calendar.removeClass(c,"hilite");Calendar.removeClass(c.parentNode,"rowhilite")}a||(a=window.event);if(c.navtype==50&&d!=c){var e=Calendar.getAbsolutePos(c);var f=c.offsetWidth;var g=a.clientX;var h;var i=true;if(g>e.x+f){h=g-e.x-f;i=false}else h=e.x-g;if(h<0)h=0;var j=c._range;var k=c._current;var l=Math.floor(h/10)%j.length;for(var m=j.length;--m>=0;)if(j[m]==k)break;while(l-- >0)if(i){if(--m<0)m=j.length-1}else if(++m>=j.length)m=0;var n=j[m];c.innerHTML=n;b.onUpdateTime()}var o=Calendar.findMonth(d);if(o){if(o.month!=b.date.getMonth()){if(b.hilitedMonth){Calendar.removeClass(b.hilitedMonth,"hilite")}Calendar.addClass(o,"hilite");b.hilitedMonth=o}else if(b.hilitedMonth){Calendar.removeClass(b.hilitedMonth,"hilite")}}else{if(b.hilitedMonth){Calendar.removeClass(b.hilitedMonth,"hilite")}var p=Calendar.findYear(d);if(p){if(p.year!=b.date.getFullYear()){if(b.hilitedYear){Calendar.removeClass(b.hilitedYear,"hilite")}Calendar.addClass(p,"hilite");b.hilitedYear=p}else if(b.hilitedYear){Calendar.removeClass(b.hilitedYear,"hilite")}}else if(b.hilitedYear){Calendar.removeClass(b.hilitedYear,"hilite")}}return Calendar.stopEvent(a)};Calendar.tableMouseDown=function(a){if(Calendar.getTargetElement(a)==Calendar.getElement(a)){return Calendar.stopEvent(a)}};Calendar.calDragIt=function(a){var b=Calendar._C;if(!(b&&b.dragging)){return false}var c;var d;if(Calendar.is_ie){d=window.event.clientY+document.body.scrollTop;c=window.event.clientX+document.body.scrollLeft}else{c=a.pageX;d=a.pageY}b.hideShowCovered();var e=b.element.style;e.left=c-b.xOffs+"px";e.top=d-b.yOffs+"px";return Calendar.stopEvent(a)};Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal){return false}cal.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev)}cal.hideShowCovered()};Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el.disabled){return false}var cal=el.calendar;cal.activeDiv=el;Calendar._C=cal;if(el.navtype!=300)with(Calendar){if(el.navtype==50){el._current=el.innerHTML;addEvent(document,"mousemove",tableMouseOver)}else addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver);addClass(el,"hilite active");addEvent(document,"mouseup",tableMouseUp)}else if(cal.isPopup){cal._dragStart(ev)}if(el.navtype==-1||el.navtype==1){if(cal.timeout)clearTimeout(cal.timeout);cal.timeout=setTimeout("Calendar.showMonthsCombo()",250)}else if(el.navtype==-2||el.navtype==2){if(cal.timeout)clearTimeout(cal.timeout);cal.timeout=setTimeout(el.navtype>0?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250)}else{cal.timeout=null}return Calendar.stopEvent(ev)};Calendar.dayMouseDblClick=function(a){Calendar.cellClick(Calendar.getElement(a),a||window.event);if(Calendar.is_ie){document.selection.empty()}};Calendar.dayMouseOver=function(a){var b=Calendar.getElement(a);if(Calendar.isRelated(b,a)||Calendar._C||b.disabled){return false}if(b.ttip){if(b.ttip.substr(0,1)=="_"){b.ttip=b.caldate.print(b.calendar.ttDateFormat)+b.ttip.substr(1)}b.calendar.tooltips.innerHTML=b.ttip}if(b.navtype!=300){Calendar.addClass(b,"hilite");if(b.caldate){Calendar.addClass(b.parentNode,"rowhilite")}}return Calendar.stopEvent(a)};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||el.disabled)return false;removeClass(el,"hilite");if(el.caldate)removeClass(el.parentNode,"rowhilite");if(el.calendar)el.calendar.tooltips.innerHTML=_TT["SEL_DATE"];return stopEvent(ev)}};Calendar.cellClick=function(a,b){var c=a.calendar;var d=false;var e=false;var f=null;if(typeof a.navtype=="undefined"){if(c.currentDateEl){Calendar.removeClass(c.currentDateEl,"selected");Calendar.addClass(a,"selected");d=c.currentDateEl==a;if(!d){c.currentDateEl=a}}c.date.setDateOnly(a.caldate);f=c.date;var g=!(c.dateClicked=!a.otherMonth);if(!g&&!c.currentDateEl)c._toggleMultipleDate(new Date(f));else e=!a.disabled;if(g)c._init(c.firstDayOfWeek,f)}else{if(a.navtype==200){Calendar.removeClass(a,"hilite");c.callCloseHandler();return}f=new Date(c.date);if(a.navtype==0)f.setDateOnly(new Date);c.dateClicked=false;var h=f.getFullYear();var i=f.getMonth();function j(a){var b=f.getDate();var c=f.getMonthDays(a);if(b>c){f.setDate(c)}f.setMonth(a)}switch(a.navtype){case 400:Calendar.removeClass(a,"hilite");var k=Calendar._TT["ABOUT"];if(typeof k!="undefined"){k+=c.showsTime?Calendar._TT["ABOUT_TIME"]:""}else{k="Help and about box text is not translated into this language.\n"+"If you know this language and you feel generous please update\n"+'the corresponding file in "lang" subdir to match calendar-en.js\n'+"and send it back to <mihai_bazon@yahoo.com> to get it into the distribution  ;-)\n\n"+"Thank you!\n"+"http://dynarch.com/mishoo/calendar.epl\n"}alert(k);return;case-2:if(h>c.minYear){f.setFullYear(h-1)}break;case-1:if(i>0){j(i-1)}else if(h-- >c.minYear){f.setFullYear(h);j(11)}break;case 1:if(i<11){j(i+1)}else if(h<c.maxYear){f.setFullYear(h+1);j(0)}break;case 2:if(h<c.maxYear){f.setFullYear(h+1)}break;case 100:c.setFirstDayOfWeek(a.fdow);return;case 50:var l=a._range;var m=a.innerHTML;for(var n=l.length;--n>=0;)if(l[n]==m)break;if(b&&b.shiftKey){if(--n<0)n=l.length-1}else if(++n>=l.length)n=0;var o=l[n];a.innerHTML=o;c.onUpdateTime();return;case 0:if(typeof c.getDateStatus=="function"&&c.getDateStatus(f,f.getFullYear(),f.getMonth(),f.getDate())){return false}break}if(!f.equalsTo(c.date)){c.setDate(f);e=true}else if(a.navtype==0)e=d=true}if(e){b&&c.callHandler()}if(d){Calendar.removeClass(a,"hilite");b&&c.callCloseHandler()}};Calendar.prototype.create=function(a){var b=null;if(!a){b=document.getElementsByTagName("body")[0];this.isPopup=true}else{b=a;this.isPopup=false}this.date=this.dateStr?new Date(this.dateStr):new Date;var c=Calendar.createElement("table");this.table=c;c.cellSpacing=0;c.cellPadding=0;c.calendar=this;Calendar.addEvent(c,"mousedown",Calendar.tableMouseDown);var d=Calendar.createElement("div");this.element=d;d.className="calendar";if(this.isPopup){d.style.position="absolute";d.style.display="none"}d.appendChild(c);var e=Calendar.createElement("thead",c);var f=null;var g=null;var h=this;var i=function(a,b,c){f=Calendar.createElement("td",g);f.colSpan=b;f.className="button";if(c!=0&&Math.abs(c)<=2)f.className+=" nav";Calendar._add_evs(f);f.calendar=h;f.navtype=c;f.innerHTML="<div unselectable='on'>"+a+"</div>";return f};g=Calendar.createElement("tr",e);var j=6;this.isPopup&&--j;this.weekNumbers&&++j;i("?",1,400).ttip=Calendar._TT["INFO"];this.title=i("",j,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT["DRAG_TO_MOVE"];this.title.style.cursor="move";i("&#x00d7;",1,200).ttip=Calendar._TT["CLOSE"]}g=Calendar.createElement("tr",e);g.className="headrow";this._nav_py=i("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT["PREV_YEAR"];this._nav_pm=i("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT["PREV_MONTH"];this._nav_now=i(Calendar._TT["TODAY"],this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT["GO_TODAY"];this._nav_nm=i("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT["NEXT_MONTH"];this._nav_ny=i("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT["NEXT_YEAR"];g=Calendar.createElement("tr",e);g.className="daynames";if(this.weekNumbers){f=Calendar.createElement("td",g);f.className="name wn";f.innerHTML=Calendar._TT["WK"]}for(var k=7;k>0;--k){f=Calendar.createElement("td",g);if(!k){f.navtype=100;f.calendar=this;Calendar._add_evs(f)}}this.firstdayname=this.weekNumbers?g.firstChild.nextSibling:g.firstChild;this._displayWeekdays();var l=Calendar.createElement("tbody",c);this.tbody=l;for(k=6;k>0;--k){g=Calendar.createElement("tr",l);if(this.weekNumbers){f=Calendar.createElement("td",g)}for(var m=7;m>0;--m){f=Calendar.createElement("td",g);f.calendar=this;Calendar._add_evs(f)}}if(this.showsTime){g=Calendar.createElement("tr",l);g.className="time";f=Calendar.createElement("td",g);f.className="time";f.colSpan=2;f.innerHTML=Calendar._TT["TIME"]||" ";f=Calendar.createElement("td",g);f.className="time";f.colSpan=this.weekNumbers?4:3;(function(){function a(a,b,c,d){var e=Calendar.createElement("span",f);e.className=a;e.innerHTML=b;e.calendar=h;e.ttip=Calendar._TT["TIME_PART"];e.navtype=50;e._range=[];if(typeof c!="number")e._range=c;else{for(var g=c;g<=d;++g){var i;if(g<10&&d>=10)i="0"+g;else i=""+g;e._range[e._range.length]=i}}Calendar._add_evs(e);return e}var b=h.date.getHours();var c=h.date.getMinutes();var d=!h.time24;var e=b>12;if(d&&e)b-=12;var i=a("hour",b,d?1:0,d?12:23);var j=Calendar.createElement("span",f);j.innerHTML=":";j.className="colon";var k=a("minute",c,0,59);var l=null;f=Calendar.createElement("td",g);f.className="time";f.colSpan=2;if(d)l=a("ampm",e?"pm":"am",["am","pm"]);else f.innerHTML=" ";h.onSetTime=function(){var a,b=this.date.getHours(),c=this.date.getMinutes();if(d){a=b>=12;if(a)b-=12;if(b==0)b=12;l.innerHTML=a?"pm":"am"}i.innerHTML=b<10?"0"+b:b;k.innerHTML=c<10?"0"+c:c};h.onUpdateTime=function(){var a=this.date;var b=parseInt(i.innerHTML,10);if(d){if(/pm/i.test(l.innerHTML)&&b<12)b+=12;else if(/am/i.test(l.innerHTML)&&b==12)b=0}var c=a.getDate();var e=a.getMonth();var f=a.getFullYear();a.setHours(b);a.setMinutes(parseInt(k.innerHTML,10));a.setFullYear(f);a.setMonth(e);a.setDate(c);this.dateClicked=false;this.callHandler()}})()}else{this.onSetTime=this.onUpdateTime=function(){}}var n=Calendar.createElement("tfoot",c);g=Calendar.createElement("tr",n);g.className="footrow";f=i(Calendar._TT["SEL_DATE"],this.weekNumbers?8:7,300);f.className="ttip";if(this.isPopup){f.ttip=Calendar._TT["DRAG_TO_MOVE"];f.style.cursor="move"}this.tooltips=f;d=Calendar.createElement("div",this.element);this.monthsCombo=d;d.className="combo";for(k=0;k<Calendar._MN.length;++k){var o=Calendar.createElement("div");o.className=Calendar.is_ie?"label-IEfix":"label";o.month=k;o.innerHTML=Calendar._SMN[k];d.appendChild(o)}d=Calendar.createElement("div",this.element);this.yearsCombo=d;d.className="combo";for(k=12;k>0;--k){var p=Calendar.createElement("div");p.className=Calendar.is_ie?"label-IEfix":"label";d.appendChild(p)}this._init(this.firstDayOfWeek,this.date);b.appendChild(this.element)};Calendar._keyEvent=function(a){var b=window._dynarch_popupCalendar;if(!b||b.multiple)return false;Calendar.is_ie&&(a=window.event);var c=Calendar.is_ie||a.type=="keypress",d=a.keyCode;if(a.ctrlKey){switch(d){case 37:c&&Calendar.cellClick(b._nav_pm);break;case 38:c&&Calendar.cellClick(b._nav_py);break;case 39:c&&Calendar.cellClick(b._nav_nm);break;case 40:c&&Calendar.cellClick(b._nav_ny);break;default:return false}}else switch(d){case 32:Calendar.cellClick(b._nav_now);break;case 27:c&&b.callCloseHandler();break;case 37:case 38:case 39:case 40:if(c){var e,f,g,h,i,j;e=d==37||d==38;j=d==37||d==39?1:7;function k(){i=b.currentDateEl;var a=i.pos;f=a&15;g=a>>4;h=b.ar_days[g][f]}k();function l(){var a=new Date(b.date);a.setDate(a.getDate()-j);b.setDate(a)}function m(){var a=new Date(b.date);a.setDate(a.getDate()+j);b.setDate(a)}while(1){switch(d){case 37:if(--f>=0)h=b.ar_days[g][f];else{f=6;d=38;continue}break;case 38:if(--g>=0)h=b.ar_days[g][f];else{l();k()}break;case 39:if(++f<7)h=b.ar_days[g][f];else{f=0;d=40;continue}break;case 40:if(++g<b.ar_days.length)h=b.ar_days[g][f];else{m();k()}break}break}if(h){if(!h.disabled)Calendar.cellClick(h);else if(e)l();else m()}}break;case 13:if(c)Calendar.cellClick(b.currentDateEl,a);break;default:return false}return Calendar.stopEvent(a)};Calendar.prototype._init=function(a,b){var c=new Date,d=c.getFullYear(),e=c.getMonth(),f=c.getDate();this.table.style.visibility="hidden";var g=b.getFullYear();if(g<this.minYear){g=this.minYear;b.setFullYear(g)}else if(g>this.maxYear){g=this.maxYear;b.setFullYear(g)}this.firstDayOfWeek=a;this.date=new Date(b);var h=b.getMonth();var i=b.getDate();var j=b.getMonthDays();b.setDate(1);var k=(b.getDay()-this.firstDayOfWeek)%7;if(k<0)k+=7;b.setDate(-k);b.setDate(b.getDate()+1);var l=this.tbody.firstChild;var m=Calendar._SMN[h];var n=this.ar_days=new Array;var o=Calendar._TT["WEEKEND"];var p=this.multiple?this.datesCells={}:null;for(var q=0;q<6;++q,l=l.nextSibling){var r=l.firstChild;if(this.weekNumbers){r.className="day wn";r.innerHTML=b.getWeekNumber();r=r.nextSibling}l.className="daysrow";var s=false,t,u=n[q]=[];for(var v=0;v<7;++v,r=r.nextSibling,b.setDate(t+1)){t=b.getDate();var w=b.getDay();r.className="day";r.pos=q<<4|v;u[v]=r;var x=b.getMonth()==h;if(!x){if(this.showsOtherMonths){r.className+=" othermonth";r.otherMonth=true}else{r.className="emptycell";r.innerHTML=" ";r.disabled=true;continue}}else{r.otherMonth=false;s=true}r.disabled=false;r.innerHTML=this.getDateText?this.getDateText(b,t):t;if(p)p[b.print("%Y%m%d")]=r;if(this.getDateStatus){var y=this.getDateStatus(b,g,h,t);if(this.getDateToolTip){var z=this.getDateToolTip(b,g,h,t);if(z)r.title=z}if(y===true){r.className+=" disabled";r.disabled=true}else{if(/disabled/i.test(y))r.disabled=true;r.className+=" "+y}}if(!r.disabled){r.caldate=new Date(b);r.ttip="_";if(!this.multiple&&x&&t==i&&this.hiliteToday){r.className+=" selected";this.currentDateEl=r}if(b.getFullYear()==d&&b.getMonth()==e&&t==f){r.className+=" today";r.ttip+=Calendar._TT["PART_TODAY"]}if(o.indexOf(w.toString())!=-1)r.className+=r.otherMonth?" oweekend":" weekend"}}if(!(s||this.showsOtherMonths))l.className="emptyrow"}this.title.innerHTML=Calendar._MN[h]+", "+g;this.onSetTime();this.table.style.visibility="visible";this._initMultipleDates()};Calendar.prototype._initMultipleDates=function(){if(this.multiple){for(var a in this.multiple){var b=this.datesCells[a];var c=this.multiple[a];if(!c)continue;if(b)b.className+=" selected"}}};Calendar.prototype._toggleMultipleDate=function(a){if(this.multiple){var b=a.print("%Y%m%d");var c=this.datesCells[b];if(c){var d=this.multiple[b];if(!d){Calendar.addClass(c,"selected");this.multiple[b]=a}else{Calendar.removeClass(c,"selected");delete this.multiple[b]}}}};Calendar.prototype.setDateToolTipHandler=function(a){this.getDateToolTip=a};Calendar.prototype.setDate=function(a){if(!a.equalsTo(this.date)){this._init(this.firstDayOfWeek,a)}};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date)};Calendar.prototype.setFirstDayOfWeek=function(a){this._init(a,this.date);this._displayWeekdays()};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(a){this.getDateStatus=a};Calendar.prototype.setRange=function(a,b){this.minYear=a;this.maxYear=b};Calendar.prototype.callHandler=function(){if(this.onSelected){this.onSelected(this,this.date.print(this.dateFormat))}};Calendar.prototype.callCloseHandler=function(){if(this.onClose){this.onClose(this)}this.hideShowCovered()};Calendar.prototype.destroy=function(){var a=this.element.parentNode;a.removeChild(this.element);Calendar._C=null;window._dynarch_popupCalendar=null};Calendar.prototype.reparent=function(a){var b=this.element;b.parentNode.removeChild(b);a.appendChild(b)};Calendar._checkCalendar=function(a){var b=window._dynarch_popupCalendar;if(!b){return false}var c=Calendar.is_ie?Calendar.getElement(a):Calendar.getTargetElement(a);for(;c!=null&&c!=b.element;c=c.parentNode);if(c==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(a)}};Calendar.prototype.show=function(){var a=this.table.getElementsByTagName("tr");for(var b=a.length;b>0;){var c=a[--b];Calendar.removeClass(c,"rowhilite");var d=c.getElementsByTagName("td");for(var e=d.length;e>0;){var f=d[--e];Calendar.removeClass(f,"hilite");Calendar.removeClass(f,"active")}}this.element.style.display="block";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"keypress",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar)}this.hideShowCovered()};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"keypress",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar)}this.element.style.display="none";this.hidden=true;this.hideShowCovered()};Calendar.prototype.showAt=function(a,b){var c=this.element.style;c.left=a+"px";c.top=b+"px";this.show()};Calendar.prototype.showAtElement=function(a,b){function e(a){if(a.x<0)a.x=0;if(a.y<0)a.y=0;var b=document.createElement("div");var c=b.style;c.position="absolute";c.right=c.bottom=c.width=c.height="0px";document.body.appendChild(b);var d=Calendar.getAbsolutePos(b);document.body.removeChild(b);if(Calendar.is_ie){d.y+=document.body.scrollTop;d.x+=document.body.scrollLeft}else{d.y+=window.scrollY;d.x+=window.scrollX}var e=a.x+a.width-d.x;if(e>0)a.x-=e;e=a.y+a.height-d.y;if(e>0)a.y-=e}var c=this;var d=Calendar.getAbsolutePos(a);if(!b||typeof b!="string"){this.showAt(d.x,d.y+a.offsetHeight);return true}this.element.style.display="block";Calendar.continuation_for_the_fucking_khtml_browser=function(){var f=c.element.offsetWidth;var g=c.element.offsetHeight;c.element.style.display="none";var h=b.substr(0,1);var i="l";if(b.length>1){i=b.substr(1,1)}switch(h){case"T":d.y-=g;break;case"B":d.y+=a.offsetHeight;break;case"C":d.y+=(a.offsetHeight-g)/2;break;case"t":d.y+=a.offsetHeight-g;break;case"b":break}switch(i){case"L":d.x-=f;break;case"R":d.x+=a.offsetWidth;break;case"C":d.x+=(a.offsetWidth-f)/2;break;case"l":d.x+=a.offsetWidth-f;break;case"r":break}d.width=f;d.height=g+40;c.monthsCombo.style.display="none";e(d);c.showAt(d.x,d.y)};if(Calendar.is_khtml)setTimeout("Calendar.continuation_for_the_fucking_khtml_browser()",10);else Calendar.continuation_for_the_fucking_khtml_browser()};Calendar.prototype.setDateFormat=function(a){this.dateFormat=a};Calendar.prototype.setTtDateFormat=function(a){this.ttDateFormat=a};Calendar.prototype.parseDate=function(a,b){if(!b)b=this.dateFormat;this.setDate(Date.parseDate(a,b))};Calendar.prototype.hideShowCovered=function(){function a(a){var b=a.style.visibility;if(!b){if(document.defaultView&&typeof document.defaultView.getComputedStyle=="function"){if(!Calendar.is_khtml)b=document.defaultView.getComputedStyle(a,"").getPropertyValue("visibility");else b=""}else if(a.currentStyle){b=a.currentStyle.visibility}else b=""}return b}if(!Calendar.is_ie&&!Calendar.is_opera)return;var b=new Array("applet","iframe","select");var c=this.element;var d=Calendar.getAbsolutePos(c);var e=d.x;var f=c.offsetWidth+e;var g=d.y;var h=c.offsetHeight+g;for(var i=b.length;i>0;){var j=document.getElementsByTagName(b[--i]);var k=null;for(var l=j.length;l>0;){k=j[--l];d=Calendar.getAbsolutePos(k);var m=d.x;var n=k.offsetWidth+m;var o=d.y;var p=k.offsetHeight+o;if(this.hidden||m>f||n<e||o>h||p<g){if(!k.__msh_save_visibility){k.__msh_save_visibility=a(k)}k.style.visibility=k.__msh_save_visibility}else{if(!k.__msh_save_visibility){k.__msh_save_visibility=a(k)}k.style.visibility="hidden"}}}};Calendar.prototype._displayWeekdays=function(){var a=this.firstDayOfWeek;var b=this.firstdayname;var c=Calendar._TT["WEEKEND"];for(var d=0;d<7;++d){b.className="day name";var e=(d+a)%7;if(d){b.ttip=Calendar._TT["DAY_FIRST"].replace("%s",Calendar._DN[e]);b.navtype=100;b.calendar=this;b.fdow=e;Calendar._add_evs(b)}if(c.indexOf(e.toString())!=-1){Calendar.addClass(b,"weekend")}b.innerHTML=Calendar._SDN[(d+a)%7];b=b.nextSibling}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none"};Calendar.prototype._dragStart=function(ev){if(this.dragging){return}this.dragging=true;var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft}else{posY=ev.clientY+window.scrollY;posX=ev.clientX+window.scrollX}var st=this.element.style;this.xOffs=posX-parseInt(st.left);this.yOffs=posY-parseInt(st.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd)}};Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1e3;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date.parseDate=function(a,b){var c=new Date;var d=0;var e=-1;var f=0;var g=a.split(/\W+/);var h=b.match(/%./g);var i=0,j=0;var k=0;var l=0;for(i=0;i<g.length;++i){if(!g[i])continue;switch(h[i]){case"%d":case"%e":f=parseInt(g[i],10);break;case"%m":e=parseInt(g[i],10)-1;break;case"%Y":case"%y":d=parseInt(g[i],10);d<100&&(d+=d>29?1900:2e3);break;case"%b":case"%B":for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,g[i].length).toLowerCase()==g[i].toLowerCase()){e=j;break}}break;case"%H":case"%I":case"%k":case"%l":k=parseInt(g[i],10);break;case"%P":case"%p":if(/pm/i.test(g[i])&&k<12)k+=12;else if(/am/i.test(g[i])&&k>=12)k-=12;break;case"%M":l=parseInt(g[i],10);break}}if(isNaN(d))d=c.getFullYear();if(isNaN(e))e=c.getMonth();if(isNaN(f))f=c.getDate();if(isNaN(k))k=c.getHours();if(isNaN(l))l=c.getMinutes();if(d!=0&&e!=-1&&f!=0)return new Date(d,e,f,k,l,0);d=0;e=-1;f=0;for(i=0;i<g.length;++i){if(g[i].search(/[a-zA-Z]+/)!=-1){var m=-1;for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,g[i].length).toLowerCase()==g[i].toLowerCase()){m=j;break}}if(m!=-1){if(e!=-1){f=e+1}e=m}}else if(parseInt(g[i],10)<=12&&e==-1){e=g[i]-1}else if(parseInt(g[i],10)>31&&d==0){d=parseInt(g[i],10);d<100&&(d+=d>29?1900:2e3)}else if(f==0){f=g[i]}}if(d==0)d=c.getFullYear();if(e!=-1&&f!=0)return new Date(d,e,f,k,l,0);return c};Date.prototype.getMonthDays=function(a){var b=this.getFullYear();if(typeof a=="undefined"){a=this.getMonth()}if(0==b%4&&(0!=b%100||0==b%400)&&a==1){return 29}else{return Date._MD[a]}};Date.prototype.getDayOfYear=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var b=new Date(this.getFullYear(),0,0,0,0,0);var c=a-b;return Math.floor(c/Date.DAY)};Date.prototype.getWeekNumber=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var b=a.getDay();a.setDate(a.getDate()-(b+6)%7+3);var c=a.valueOf();a.setMonth(0);a.setDate(4);return Math.round((c-a.valueOf())/(7*864e5))+1};Date.prototype.equalsTo=function(a){return this.getFullYear()==a.getFullYear()&&this.getMonth()==a.getMonth()&&this.getDate()==a.getDate()&&this.getHours()==a.getHours()&&this.getMinutes()==a.getMinutes()};Date.prototype.setDateOnly=function(a){var b=new Date(a);this.setDate(1);this.setFullYear(b.getFullYear());this.setMonth(b.getMonth());this.setDate(b.getDate())};Date.prototype.print=function(a){var b=this.getMonth();var c=this.getDate();var d=this.getFullYear();var e=this.getWeekNumber();var f=this.getDay();var g={};var h=this.getHours();var i=h>=12;var j=i?h-12:h;var k=this.getDayOfYear();if(j==0)j=12;var l=this.getMinutes();var m=this.getSeconds();g["%a"]=Calendar._SDN[f];g["%A"]=Calendar._DN[f];g["%b"]=Calendar._SMN[b];g["%B"]=Calendar._MN[b];g["%C"]=1+Math.floor(d/100);g["%d"]=c<10?"0"+c:c;g["%e"]=c;g["%H"]=h<10?"0"+h:h;g["%I"]=j<10?"0"+j:j;g["%j"]=k<100?k<10?"00"+k:"0"+k:k;g["%k"]=h;g["%l"]=j;g["%m"]=b<9?"0"+(1+b):1+b;g["%M"]=l<10?"0"+l:l;g["%n"]="\n";g["%p"]=i?"PM":"AM";g["%P"]=i?"pm":"am";g["%s"]=Math.floor(this.getTime()/1e3);g["%S"]=m<10?"0"+m:m;g["%t"]="\t";g["%U"]=g["%W"]=g["%V"]=e<10?"0"+e:e;g["%u"]=f+1;g["%w"]=f;g["%y"]=(""+d).substr(2,2);g["%Y"]=d;g["%%"]="%";var n=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml)return a.replace(n,function(a){return g[a]||a});var o=a.match(n);for(var p=0;p<o.length;p++){var q=g[o[p]];if(q){n=new RegExp(o[p],"g");a=a.replace(n,q)}}return a};Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(a){var b=new Date(this);b.__msh_oldSetFullYear(a);if(b.getMonth()!=this.getMonth())this.setDate(28);this.__msh_oldSetFullYear(a)};window._dynarch_popupCalendar=null;